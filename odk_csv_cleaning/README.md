# Clean Form CSVs

This script is meant to aid in the cleaning and merging of data from ODK-Form CSVs. 

clean_form_csvs.py handles one argument (after [file]) at a time, with an option to add -n|--name for a custom output name of a given file.

You can run each argument individually on a given file, or as part of a batch process on a directory of files.

## Dependencies

* python2.7
* pandas

### Overview

The instructions found below go into detail on how to install python (2.7), pips (if missing) and pandas (a required module).

If you have a working version of python27 on your PATH, you can run the script one time (calling --help) to initiate a pandas install using pip. The script will then install the pandas module via pip for you, without you having to do any additional steps.

#### Instructions for installing python: 

* https://www.python.org/downloads/release/python-2714/
* https://www.howtogeek.com/197947/how-to-install-python-on-windows/
* https://askubuntu.com/questions/458061/how-do-i-install-python-through-the-terminal

#### Instructions for installing pip:

* https://pip.pypa.io/en/stable/installing/

#### Instructions for installing pandas:

* https://pandas.pydata.org/pandas-docs/stable/install.html#installing-from-pypi

## Steps to Run

#### Making the script executable:

You can make the script name executable by running ```chmod +x clean_form_csvs.py``` and executing it using ```./clean_form_csvs.py```

#### Running the script without making it name executable:

```python clean_form_csvs.py <some argument>``` to call the script into action.

*Single File Example 01:* ```python clean_form_csvs.py [pathtocsv] -p```

*Single File Example 02:* ```python clean_form_csvs.py [pathtocsv] -f```

*Multiple File Example 01:* ```python clean_form_csvs.py [/directoryofcsvs] -p```

*Multiple File Example 02:* ```python clean_form_csvs.py [/directoryofcsvs] -bm -n```

#### Directions

Start by prepping each CSV (or directory of csvs), with the ```-p``` command (providing a path to the file, or directory of files). This properly formats the CSV(s) for use (right-away) in excel or elsewhere by re-writing them in traditional ',' separated form.

Once CSVs are prepped for use and readability, proceed to address other formatting/processing concerns with the host of commands at your disposal.

For more help, run ```python clean_form_csvs.py --help```

#### Arguments

*Some functions of this script rely on existing form architecture. Pending updates to forms used in the field, some of the functions below will need additional updating, or even removal. Others (such as batch merge), will remain useful in spite of form column changes.*

**positional arguments:**
  * ```file```                  Provide a csv file, or path to directory of csv's for
                        this argument

**optional arguments:**
  * ```-h```, ```--help```            show this help message and exit
  * ```-p```, ```--prepcsv```         **DO THIS FIRST!** Prep raw_csvs from Kobo for
                        processing.
  * ```-n```, ```--name```            Add a custom name for output file. This can be
                        combined with most other arguments.
  * ```-f```, ```--fixlatlon```       Fix Lat/Lon Column Names
  * ```-cw```, ```--cleanwhitespace```
                        Clean leading/trailing whitespace
  * ```-rc```, ```--removecolumn```   Remove columns with ALL empty values
  * ```-rd```, ```--removeduplicates```
                        Remove duplicate columns generated by multiple choice
                        questions
  * ```-rf```, ```--removefield```    Remove unneeded form-generated fields.
  * ```-tc```, ```--titlecase```      Format row values to title casing.
  * ```-rof```, ```--removeosmfield```
                        *OSM Specific* Remove non-osm fields.
  * ```-oc```, ```--osmconform```     *OSM Specific* Convert '_' in column headings to ':'
                        as accepted by osm
  * ```-bm```, ```--batchmergecsv```  Batch merge CSVs of same type. Provide full path for
                        directories outside your working directory. Provide
                        '.' if your files are in your current working
                        directory.
  * ```-brd```, ```--batchremoveduplicates```
                        Remove duplicate columns generated by multiple choice
                        questions. Provide full path for directories outside
                        your working directory. Provide '.' if your files are
                        in your current working directory.
  * ```-bcw```, ```--batchcleanwhitespace```
                        Batch clean leading/trailing whitespace. Provide full
                        path for directories outside your working directory.
                        Provide '.' if your files are in your current working
                        directory.
  * ```-brc```, ```--batchremovecolumn```
                        Batch remove columns with ALL empty values. Provide
                        full path for directories outside your working
                        directory. Provide '.' if your files are in your
                        current working directory.
  * ```-bf```, ```--batchfixlatlon```
                        Batch Fix Lat/Lon Column Names. Provide full path for
                        directories outside your working directory. Provide
                        '.' if your files are in your current working
                        directory.
  * ```-brf```, ```--batchremovefield```
                        Batch unneeded form-generated fields. Provide full
                        path for directories outside your working directory.
                        Provide '.' if your files are in your current working
                        directory.
  * ```-btc```, ```--batchtitlecase```
                        Format row values to title casing.
  * ```-brof```, ```--batchremoveosmfield```
                        *OSM Specific* Batch remove non-osm fields. Provide
                        full path for directories outside your working
                        directory. Provide '.' if your files are in your
                        current working directory.
  * ```-boc```, ```--batchosmconform```
                        *OSM Specific* Batch convert '_' in column headings to
                        ':' as accepted by osm. Provide full path for
                        directories outside your working directory. Provide
                        '.' if your files are in your current working
                        directory.